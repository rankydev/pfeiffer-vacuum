version: '3'

services:
  dev2:
    image: '${CI_REGISTRY}/${CI_PROJECT_PATH}:${CI_COMMIT_REF_SLUG}'
    restart: always
    ports:
      - '3000:3000'
    environment:
      # must match with the second entry in ports section
      - PORT=3000
      - NODE_ENV=${NODE_ENV}
      # Language
      - DEFAULT_LANGUAGE_CODE=${DEFAULT_LANGUAGE_CODE}
      - LANGUAGE_CODES=${LANGUAGE_CODES}
      # Region
      - REGION_CODES=${REGION_CODES}
      - DEFAULT_REGION_CODE=${DEFAULT_REGION_CODE}
      - CURRENT_REGION_CODE=${CURRENT_REGION_CODE}
      # storyblok
      - STORYBLOK_ACCESS_TOKEN=${STORYBLOK_ACCESS_TOKEN}
      - STORYBLOK_SPACE_ID=${STORYBLOK_SPACE_ID}
      - STORYBLOK_VERSION=${STORYBLOK_VERSION}
      - STORYBLOK_RESOLVE_RELATIONS=${STORYBLOK_RESOLVE_RELATIONS}
      - STORYBLOK_RESOLVE_LINKS=${STORYBLOK_RESOLVE_LINKS}
      - STORYBLOK_RESOLVE_ASSETS=${STORYBLOK_RESOLVE_ASSETS}
      - STORYBLOK_CONTENT_TYPES=${STORYBLOK_CONTENT_TYPES}
      - STORYBLOK_EXCLUDE_ROUTES=${STORYBLOK_EXCLUDE_ROUTES}
      - STORYBLOK_OAUTH_TOKEN=${STORYBLOK_OAUTH_TOKEN}
      - BASE_URL=${CI_ENVIRONMENT_URL}
      - CI_COMMIT_SHORT_SHA=${CI_COMMIT_SHORT_SHA}
      - CI_COMMIT_REF_NAME=${CI_COMMIT_REF_NAME}
      - CI_PROJECT_URL=${CI_PROJECT_URL}
      # node setup
      #- REJECT_UNAUTHORIZED=true #don't trust all certificates
      #Storefront
      #- STOREFRONT_BASE_URL=${CI_ENVIRONMENT_URL}
      # hybris
      #- SHOP_BASE_URL=
      #- SHOP_IMAGE_URL=,
      #- SHOP_CLIENT_ID=pfeiffer_viewer
      #- SHOP_SECRET=secret,
      # vsm
      #- VSM_BASE_URL=https://testing-pv.vsm-cloud.com
      #- VSM_TECHNICAL_USER_TOKEN=10fff01e72e34e4fe33fbc84e5c6aa80017aac08
      # determines whether all service features (VSM) are shown or not
      #- SERVICE_PORTAL_ACTIVE=true
      # logging
      #- CONSOLA_LEVEL=3 # { 0: 'error', 1: 'warn', 2: 'log', 3: 'info', 4: 'debug', 5: 'trace', Infinite: silent }
      # Google Tag Manager for Google Analytics
      #- GOOGLE_TAG_MANAGER_ID=${CI_GOOGLE_TAG_MANAGER_ID}
